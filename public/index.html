<script>
  async function connect() {
    const phoneNumber = document.getElementById('phoneNumber').value;
    const output = document.getElementById('output');
    output.textContent = 'Connecting...';
    output.className = '';

    try {
      const response = await fetch('/connect', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ phoneNumber })
      });
      const result = await response.json();

      if (result.status === 'pairing') {
        output.innerHTML = `QR Code: <img src="${result.qr}" alt="QR Code" style="max-width: 200px;"><br>Scan this in WhatsApp > Linked Devices`;
        output.className = 'success';
      } else if (result.status === 'connected') {
        output.textContent = 'Successfully connected to WhatsApp!';
        output.className = 'success';
      }
    } catch (error) {
      output.textContent = `Error: ${error.message}`;
      output.className = 'error';
    }
  }
</script>
